<!DOCTYPE html>
<html>
<head>
  <title>Camp Scheduler</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .tabs { margin-bottom: 20px; }
    .tab-button {
      padding: 10px 20px;
      cursor: pointer;
      border: 1px solid #ccc;
      background: #f0f0f0;
      margin-right: 5px;
    }
    .tab-button.active {
      background: #007BFF;
      color: white;
      font-weight: bold;
    }
    .tab-content { display: none; }
    .tab-content.active { display: block; }

    table { border-collapse: collapse; margin-top: 20px; width: 100%; }
    th, td {
      border: 1px solid #000;
      padding: 8px;
      text-align: center;
      min-width: 80px;
    }
    .division-header {
      font-weight: bold;
      color: white;
    }
  </style>
</head>
<body>

  <h1>Camp Scheduler</h1>

  <!-- Tabs -->
  <div class="tabs">
    <button class="tab-button active" onclick="showTab('setup')">Setup & Configuration</button>
    <button class="tab-button" onclick="showTab('schedule')">Daily Schedule</button>
  </div>

  <!-- Setup & Configuration Tab -->
  <div id="setup" class="tab-content active">
    <h2>Setup & Configuration</h2>

    <h3>Bunks</h3>
    <input id="bunkInput" placeholder="Enter bunk name">
    <button onclick="addBunk()">Add Bunk</button>
    <ul id="bunkList"></ul>

    <h3>Divisions</h3>
    <input id="divisionInput" placeholder="Enter division name">
    <button onclick="addDivision()">Add Division</button>
    <div id="divisionButtons"></div>

    <h3>Times</h3>
    <input id="startTime" placeholder="Start time (e.g., 9:00)">
    <input id="endTime" placeholder="End time (e.g., 17:00)">
    <input id="increment" placeholder="Increment (e.g., 30)">
    <button onclick="generateTimes()">Generate Times</button>
    <ul id="timeList"></ul>
  </div>

  <!-- Daily Schedule Tab -->
  <div id="schedule" class="tab-content">
    <h2>Daily Schedule</h2>
    <table id="scheduleTable">
      <thead>
        <tr>
          <th>Time</th>
          <th id="bunkHeaders">Bunks / Divisions</th>
        </tr>
      </thead>
      <tbody id="scheduleBody"></tbody>
    </table>
  </div>

  <script>
    let bunks = [];
    let times = [];
    let divisions = {};
    let availableDivisions = [];
    let colors = ["#4CAF50","#2196F3","#FF5722","#9C27B0","#E91E63","#FF9800","#795548"];
    let divisionColorIndex = 0;

    // Handle tabs
    function showTab(tabId) {
      document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
      document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
      document.querySelector(`button[onclick="showTab('${tabId}')"]`).classList.add('active');
      document.getElementById(tabId).classList.add('active');
      if(tabId === "schedule") updateScheduleTable();
    }

    // Add bunk
    function addBunk() {
      const input = document.getElementById('bunkInput');
      if(input.value.trim() !== "") {
        bunks.push({ name: input.value.trim(), division: null });
        renderBunkList();
        input.value = "";
      }
    }

    function renderBunkList() {
      const ul = document.getElementById('bunkList');
      ul.innerHTML = "";
      bunks.forEach((bunk, index) => {
        const li = document.createElement('li');
        li.textContent = bunk.name + (bunk.division ? " ("+bunk.division+")" : "");
        li.onclick = () => editBunk(index);
        ul.appendChild(li);
      });
    }

    function editBunk(index) {
      const newName = prompt("Edit bunk name:", bunks[index].name);
      if(newName) {
        bunks[index].name = newName.trim();
        renderBunkList();
      }
    }

    // Add division
    function addDivision() {
      const input = document.getElementById('divisionInput');
      if(input.value.trim() !== "") {
        const name = input.value.trim();
        const color = colors[divisionColorIndex % colors.length];
        divisionColorIndex++;
        divisions[name] = { color: color };
        availableDivisions.push(name);
        renderDivisionButtons();
        input.value = "";
      }
    }

    function renderDivisionButtons() {
      const container = document.getElementById("divisionButtons");
      container.innerHTML="";
      availableDivisions.forEach((divName)=>{
        const divObj = divisions[divName];
        const btn = document.createElement("button");
        btn.textContent = divName;
        btn.style.backgroundColor = divObj.color;
        btn.style.color = "white";
        btn.onclick = ()=>assignDivision(divName);

        const colorInput = document.createElement("input");
        colorInput.type = "color";
        colorInput.value = divObj.color;
        colorInput.oninput = (e)=> {
          divisions[divName].color = e.target.value;
          renderDivisionButtons();
        };

        const disableColor = document.createElement("input");
        disableColor.type = "checkbox";
        disableColor.title = "Disable color";
        disableColor.onchange = (e)=>{
          if(e.target.checked) {
            divisions[divName].color = "transparent";
          } else {
            divisions[divName].color = colorInput.value;
          }
          renderDivisionButtons();
        };

        container.appendChild(btn);
        container.appendChild(colorInput);
        container.appendChild(disableColor);
        container.appendChild(document.createElement("br"));
      });
    }

    function assignDivision(divName) {
      const bunkName = prompt("Enter bunk name to assign to " + divName + ":");
      const bunk = bunks.find(b => b.name === bunkName);
      if(bunk) {
        bunk.division = divName;
        renderBunkList();
      } else {
        alert("Bunk not found");
      }
    }

    // Generate times
    function generateTimes() {
      const start = document.getElementById("startTime").value;
      const end = document.getElementById("endTime").value;
      const inc = parseInt(document.getElementById("increment").value);
      if(!start || !end || !inc) return;

      let [sh, sm] = start.split(":").map(Number);
      let [eh, em] = end.split(":").map(Number);
      let startDate = new Date(0,0,0,sh,sm);
      let endDate = new Date(0,0,0,eh,em);
      times = [];

      while(startDate < endDate) {
        let next = new Date(startDate.getTime() + inc*60000);
        let display = formatTime(startDate) + " - " + formatTime(next);
        times.push(display);
        startDate = next;
      }
      renderTimeList();
    }

    function renderTimeList() {
      const ul = document.getElementById("timeList");
      ul.innerHTML = "";
      times.forEach(t=>{
        const li = document.createElement("li");
        li.textContent = t;
        ul.appendChild(li);
      });
    }

    function formatTime(date) {
      let h = date.getHours();
      let m = date.getMinutes().toString().padStart(2,"0");
      let suffix = h >= 12 ? "PM" : "AM";
      h = h % 12 || 12;
      return h + ":" + m + " " + suffix;
    }

    // Update schedule table
    function updateScheduleTable() {
      const headerRow = document.querySelector("#scheduleTable thead tr");
      headerRow.innerHTML = "<th>Time</th>";
      availableDivisions.forEach(div=>{
        const th = document.createElement("th");
        th.textContent = div;
        th.className = "division-header";
        th.style.backgroundColor = divisions[div].color;
        headerRow.appendChild(th);
      });

      const body = document.getElementById("scheduleBody");
      body.innerHTML="";
      times.forEach(t=>{
        const tr = document.createElement("tr");
        const timeCell = document.createElement("td");
        timeCell.textContent = t;
        tr.appendChild(timeCell);
        availableDivisions.forEach(div=>{
          const td = document.createElement("td");
          td.textContent = bunks.filter(b=>b.division===div).map(b=>b.name).join(", ");
          tr.appendChild(td);
        });
        body.appendChild(tr);
      });
    }

    // Handle Enter key events
    document.addEventListener("keydown", (e)=>{
      if(e.key === "Enter") {
        if(document.activeElement.id==="bunkInput") addBunk();
        if(document.activeElement.id==="divisionInput") addDivision();
        if(document.activeElement.id==="startTime") document.getElementById("endTime").focus();
        if(document.activeElement.id==="endTime") document.getElementById("increment").focus();
        if(document.activeElement.id==="increment") generateTimes();
      }
    });
  </script>
</body>
</html>
