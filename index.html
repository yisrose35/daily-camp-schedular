<script>
    function showTab(id) {
     document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
     document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
     document.getElementById(id).classList.add('active');
     document.querySelector(`.tab-button[onclick^="showTab('${id}')"]`)?.classList.add('active');

     if (id === 'schedule') {
       window.updateTable?.();
     } else if (id === 'leagues') {
       window.initLeaguesTab?.();
     } else if (id === 'fixed-activities') {
       window.DailyActivities?.onDivisionsChanged?.();
     }
     // Note: initDailyOverrides is called from the button click itself
    }
    
    // =============================================
    // ===== START OF BOOT FUNCTION FIX =====
    // =============================================
    
    // This is simpler and GUARANTEES all 'defer' scripts
    // have run before boot() is called.
    document.addEventListener("DOMContentLoaded", boot);

    function boot() {
      // 1. Init Calendar (loads date, save/load fns, migration)
      if (window.initCalendar) {
        window.initCalendar();
      } else {
        console.error("Fatal: calendar.js init not found.");
      }

      // 2. Init App1 (loads bunks, divisions, fields)
      if (window.initApp1) {
        window.initApp1();
      } else {
        console.error("Fatal: app1.js init not found.");
      }

      // 3. Init Leagues (loads league data, renders tab)
      if (window.initLeagues) {
        window.initLeagues();
      } else {
        console.warn("Leagues.js init not found.");
      }

      // 4. Init Fixed Activities (renders list)
      if (window.DailyActivities && typeof window.DailyActivities.init === "function") {
        window.DailyActivities.init();
      } else {
        console.warn("DailyActivities not loaded yet.");
      }
      
      // 5. Init Schedule System (loads today's schedule)
      if (window.initScheduleSystem) {
         window.initScheduleSystem();
      } else {
         console.warn("initScheduleSystem not found.");
      }
    }
    // =============================================
    // ===== END OF BOOT FUNCTION FIX =====
    // =============================================
  </script>
  
  <script src="calendar.js" defer></script>
  <script src="daily_overrides.js" defer></script>
  <script src="app1.js" defer></script>
  <script src="daily_activities.js" defer></script>
  <script src="leagues.js" defer></script>     
  <script src="league_scheduling.js" defer></script>
  <script src="app2.js" defer></script>
</body>
</html>
