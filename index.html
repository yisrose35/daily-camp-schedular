<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Camp Scheduler</title>
    <link rel="stylesheet" href="styles.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

    <div id="welcome-screen" style="display: none;">
        <img src="https://placehold.co/150x150/007bff/ffffff?text=TCS&font=arial" alt="Camp Scheduler Logo" class="welcome-logo">
        <h2 id="welcome-title">Welcome to The Camp Scheduler</h2>
        <p>Please enter your camp's name to get started.</p>
        <input type="text" id="camp-name-input" placeholder="E.g., Camp Adventure">
        <button id="begin-btn">Begin</button>
    </div>

    <div id="main-app-container" style="display: none;">
        <h1>üèïÔ∏è Camp Scheduler</h1>

        <div style="padding: 10px 15px; background: #f4f4f4; border-radius: 8px; margin-bottom: 20px; border: 1px solid #ddd;">
            <label for="calendar-date-picker" style="font-weight: bold; margin-right: 10px; font-size: 1.1em;">Current Schedule Date:</label>
            <input type="date" id="calendar-date-picker" style="font-size: 1.1em; padding: 5px;">
        </div>

        <div class="tabs">
            <button class="tab-button active" onclick="showTab('setup')">Setup (Bunks/Divisions)</button>
            <button class="tab-button" onclick="showTab('fields'); window.initFieldsTab?.();">Fields</button>
            <button class="tab-button" onclick="showTab('special_activities'); window.initSpecialActivitiesTab?.();">Special Activities</button>
            
            <button class="tab-button" onclick="showTab('master-scheduler'); window.initMasterScheduler?.();">
                üóìÔ∏è Master Scheduler (Templates)
            </button>
            <button class="tab-button" onclick="showTab('schedule')">Daily Schedule (View)</button>
            <button class="tab-button" onclick="showTab('leagues'); window.initLeagues?.();">Leagues</button>
            <button class="tab-button" onclick="showTab('specialty-leagues'); window.initSpecialtyLeagues?.();">üèÜ Specialty Leagues</button>
            <button class="tab-button" onclick="showTab('daily-adjustments'); window.initDailyAdjustments?.();">Daily Adjustments</button>
            <button class="tab-button" onclick="showTab('report'); window.initReportTab?.();">Report</button>
            <button class="tab-button" onclick="showTab('updates'); window.initUpdatesTab?.();">Updates</button>
            <button class="tab-button" onclick="showTab('helper'); window.initHelperTab?.();">Help & Guide</button>
        </div>

        <div id="setup" class="tab-content active">
            <h3>Add Bunks</h3>
            <input id="bunkInput" placeholder="Enter bunk (e.g., Bunk 1)">
            <button id="addBunkBtn">Add Bunk</button>
            <div id="unassignedBunks" class="bunk-container"></div>

            <h3>Add Divisions</h3>
            <p style="font-size: 0.9em; color: #555;">
                Add divisions, then set the start and end time for each division.
            </p>
            <input id="divisionInput" placeholder="Enter division name (e.g., 5th Grade)">
            <button id="addDivisionBtn">Add Division</button>
            <label style="margin-left:8px;"><input type="checkbox" id="enableColor" checked> Enable Colors</label>
            <div id="divisionButtons" style="margin-top:8px;"></div>
            
            <hr style="margin: 20px 0;">
            
            <h3>Clear Schedules & History</h3>
            <p>Use these buttons to clear saved schedule data. Your Setup will NOT be affected.</p>

            <button id="eraseTodayBtn"
                style="background: #db7a00; color: #fff; padding: 8px 12px; border: none; border-radius: 4px;
                cursor: pointer; margin-right: 8px;"
                onclick="if(confirm('Are you sure you want to delete the schedule for today?')) window.eraseCurrentDailyData?.();">
                Delete ONLY This Day's Schedule
            </button>

            <button id="eraseAllSchedulesBtn"
                style="background: #c0392b;
                color: #fff; padding: 8px 12px; border: none; border-radius: 4px; cursor: pointer;"
                onclick="if(confirm('Are you sure you want to delete ALL saved schedules for ALL days? Your setup will be kept.')) window.eraseAllDailyData?.();">
                Delete ALL Daily Schedules
            </button>
            
            <button id="eraseHistoryBtn"
                style="background: #5e35b1;
                color: #fff; padding: 8px 12px; border: none; border-radius: 4px; cursor: pointer; margin-left: 8px;"
                onclick="if(confirm('Are you sure you want to reset all activity rotation history?')) window.eraseRotationHistory?.();">
                Reset Activity History
            </button>

            <hr style="margin: 20px 0;">

            <h3>Backup & Restore</h3>
            <p>Save all your setup to a file, or restore it from a backup.</p>
            <button id="exportBackupBtn"
                style="background: #007bff; color: #fff; padding: 8px 12px; border: none; border-radius: 4px; cursor: pointer;">
                Export All Data to File
            </button>
            <button id="importBackupBtn"
                style="background: #28a745; color: #fff; padding: 8px 12px; border: none; border-radius: 4px; cursor: pointer; margin-left: 8px;">
                Import Data from File
            </button>
            <input type="file" id="importFileInput" accept=".json" style="display: none;">

            <button id="restoreAutoSaveBtn" 
                style="background: #6c757d; color: #fff; padding: 8px 12px; border: none; border-radius: 4px; cursor: pointer; margin-left: 8px;"
                onclick="window.restoreAutoSave?.()">
                Recall Last Auto-Save
            </button>
            
            <button id="forceSaveBtn" 
                style="background: #17a2b8; color: #fff; padding: 8px 12px; border: none; border-radius: 4px; cursor: pointer; margin-left: 8px;"
                onclick="window.forceAutoSave?.()">
                Save Now
            </button>

            <hr style="margin: 20px 0;">

            <h3>Erase All Data</h3>
            <p><strong>‚ö†Ô∏è Warning:</strong> This deletes everything (Schedules, History, Setup).</p>

            <button id="eraseAllBtn" style="background:#c0392b;color:#fff;">
                Erase All Camp Data (Reset Application)
            </button>
        </div> 
        
        <div id="fields" class="tab-content"></div>
        <div id="special_activities" class="tab-content"></div>
        
        <div id="master-scheduler" class="tab-content">
            <div id="master-scheduler-content"></div>
        </div>
        
        <div id="schedule" class="tab-content">
            <h3>Daily Schedule (View)</h3>
            <p>This tab shows the final, "filled-in" schedule.</p>
            <div id="scheduleTable"></div>
        </div>

        <div id="leagues" class="tab-content">
            <div id="leaguesContainer"></div>
        </div>

        <div id="specialty-leagues" class="tab-content">
            <h2>üèÜ Specialty Leagues</h2>
            <div id="specialtyLeaguesContainer"></div>
        </div>

        <div id="daily-adjustments" class="tab-content">
            <div id="daily-adjustments-content"></div>
        </div>
        
        <div id="report" class="tab-content">
            <div id="report-content"></div>
        </div>

        <div id="updates" class="tab-content">
            <div id="updates-content"></div>
        </div>

        <div id="helper" class="tab-content">
            <div id="helper-content"></div>
        </div>
    </div> 

    <script src="welcome.js" defer></script>
    <script src="calendar.js" defer></script>
    <script src="app1.js" defer></script>
    <script src="daily_adjustments.js" defer></script>
    <script src="fields.js" defer></script>
    <script src="special_activities.js" defer></script>
    <script src="leagues.js" defer></script>
    <script src="specialty_leagues.js" defer></script> 
    <script src="master_schedule_builder.js" defer></script>
    <script src="scheduler_logic_core.js" defer></script>
    <script src="scheduler_logic_fillers.js" defer></script>
    <script src="scheduler_ui.js" defer></script>
    <script src="analytics.js" defer></script>
    <script src="helper.js" defer></script>
    <script src="updates.js" defer></script> <script>
        function showTab(id) {
            document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.querySelector(`.tab-button[onclick^="showTab('${id}')"]`)?.classList.add('active');

            if (id === 'schedule') window.updateTable?.();
            else if (id === 'leagues') window.initLeagues?.();
            else if (id === 'specialty-leagues') window.initSpecialtyLeagues?.();
            else if (id === 'master-scheduler') window.initMasterScheduler?.();
            else if (id === 'fields') window.initFieldsTab?.();
            else if (id === 'special_activities') window.initSpecialActivitiesTab?.();
            else if (id === 'daily-adjustments') window.initDailyAdjustments?.();
            else if (id === 'report') window.initReportTab?.(); 
            else if (id === 'helper') window.initHelperTab?.();
            else if (id === 'updates') window.initUpdatesTab?.(); // NEW
        }
    </script>
</body>
</html>
