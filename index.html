<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Camp Scheduler Pro</title>
    <link rel="stylesheet" href="styles.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

    <div id="welcome-screen" style="display: none;">
        <div style="background:white; padding:3rem; border-radius:16px; box-shadow:0 20px 25px -5px rgba(0,0,0,0.1); width:100%; max-width:450px; text-align:center;">
            <img src="https://placehold.co/80x80/2563eb/ffffff?text=CS&font=roboto" style="border-radius:12px; margin-bottom:1rem;">
            <h2 id="welcome-title" style="margin-bottom:0.5rem; font-size:1.5rem;">Welcome Back</h2>
            <p style="margin-bottom:2rem; color:#6b7280;">Enter your camp's name to access the dashboard.</p>
            <input type="text" id="camp-name-input" placeholder="Camp Name" style="text-align:center;">
            <button id="begin-btn" style="width:100%; margin-top:1rem; padding:0.8rem; background:#2563eb; color:white; font-size:1rem; font-weight:600; border-radius:8px; border:none; cursor:pointer;">Get Started</button>
        </div>
    </div>

    <div id="main-app-container" style="display: none;">
        
        <nav class="sidebar">
            <div class="app-logo">
                <span>ğŸ•ï¸</span> Scheduler Pro
            </div>
            
            <div class="tabs">
                <div style="font-size:0.7rem; font-weight:700; color:#475569; text-transform:uppercase; padding:0 0.75rem; margin-bottom:0.5rem; margin-top:1rem;">Core Setup</div>
                <button class="tab-button active" onclick="showTab('setup')"><span>âš™ï¸</span> Setup & Bunks</button>
                <button class="tab-button" onclick="showTab('fields'); window.initFieldsTab?.();"><span>ğŸ“</span> Fields & Locations</button>
                <button class="tab-button" onclick="showTab('special_activities'); window.initSpecialActivitiesTab?.();"><span>ğŸ¨</span> Special Activities</button>
                
                <div class="nav-divider"></div>
                
                <div style="font-size:0.7rem; font-weight:700; color:#475569; text-transform:uppercase; padding:0 0.75rem; margin-bottom:0.5rem;">Daily Operations</div>
                <button class="tab-button" onclick="showTab('master-scheduler'); window.initMasterScheduler?.();"><span>ğŸ—“ï¸</span> Master Templates</button>
                <button class="tab-button" onclick="showTab('daily-adjustments'); window.initDailyAdjustments?.();"><span>ğŸ”§</span> Daily Builder</button>
                <button class="tab-button" onclick="showTab('schedule')"><span>ğŸ“…</span> Daily View</button>
                
                <div class="nav-divider"></div>

                <div style="font-size:0.7rem; font-weight:700; color:#475569; text-transform:uppercase; padding:0 0.75rem; margin-bottom:0.5rem;">Leagues</div>
                <button class="tab-button" onclick="showTab('leagues'); window.initLeagues?.();"><span>ğŸ†</span> League Manager</button>
                <button class="tab-button" onclick="showTab('specialty-leagues'); window.initSpecialtyLeagues?.();"><span>ğŸ…</span> Specialty Leagues</button>
                
                <div class="nav-divider"></div>

                <button class="tab-button" onclick="showTab('report'); window.initReportTab?.();"><span>ğŸ“Š</span> Reports</button>
                <button class="tab-button" onclick="showTab('print'); window.initPrintCenter?.();"><span>ğŸ–¨ï¸</span> Print Center</button>
                <button class="tab-button" onclick="showTab('updates'); window.initUpdatesTab?.();"><span>ğŸ””</span> Updates</button>
                <button class="tab-button" onclick="showTab('helper'); window.initHelperTab?.();"><span>â“</span> Help</button>
            </div>
        </nav>

        <header class="app-header">
            <button id="menu-toggle" class="menu-toggle" title="Toggle Sidebar">
                â˜°
            </button>
            <h3 id="page-title" style="margin:0; border:none; font-size:1.1rem; margin-left:10px;">Dashboard</h3>
            
            <div class="date-control" style="margin-left:auto;">
                <label for="calendar-date-picker">Active Date:</label>
                <input type="date" id="calendar-date-picker">
            </div>
        </header>

        <main class="main-viewport">
            
            <div id="setup" class="tab-content active">
                <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem;">
                    <div class="card">
                        <h3>Manage Bunks</h3>
                        <div style="display:flex; gap:10px; margin-bottom:1rem;">
                            <input id="bunkInput" placeholder="Enter bunk name (e.g., Bunk 1)">
                            <button id="addBunkBtn">Add</button>
                        </div>
                        <div id="unassignedBunks" class="chips"></div>
                    </div>

                    <div class="card">
                        <h3>Manage Divisions</h3>
                        <p style="font-size:0.9em;">Create divisions and assign bunks by clicking them.</p>
                        <div style="display:flex; gap:10px; margin-bottom:1rem;">
                            <input id="divisionInput" placeholder="Enter division (e.g., Juniors)">
                            <button id="addDivisionBtn">Add</button>
                        </div>
                        <label style="font-size:0.9rem;"><input type="checkbox" id="enableColor" checked> Enable Colors</label>
                        <div id="divisionButtons" class="chips" style="margin-top:1rem;"></div>
                    </div>
                </div>

                <div class="card">
                    <h3>Data Management</h3>
                    <div style="display:flex; flex-wrap:wrap; gap:1rem;">
                        <button id="eraseTodayBtn" class="danger">Clear Today's Schedule</button>
                        <button id="eraseHistoryBtn" class="danger">Reset Rotation History</button>
                        <button id="exportBackupBtn" class="btn-secondary" style="border:1px solid #ccc;">Export Backup</button>
                        <button id="importBackupBtn" class="btn-secondary" style="border:1px solid #ccc;">Import Backup</button>
                        <input type="file" id="importFileInput" accept=".json" style="display: none;">
                        <button id="forceSaveBtn" class="primary">Save All Data Now</button>
                        <button id="eraseAllBtn" class="danger" style="margin-left:auto;">Reset App</button>
                    </div>
                </div>
            </div> 
            
            <div id="fields" class="tab-content"></div>
            <div id="special_activities" class="tab-content"></div>
            
            <div id="master-scheduler" class="tab-content">
                <div id="master-scheduler-content"></div>
            </div>
            
            <div id="schedule" class="tab-content">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:1.5rem;">
                    <h2 style="margin:0;">Daily Schedule</h2>
                    <button onclick="window.validateSchedule?.()" class="btn-secondary" style="background:#fff7ed; color:#c2410c; border:1px solid #fdba74;">âš ï¸ Validate Schedule</button>
                </div>
                <div id="scheduleTable"></div>
            </div>

            <div id="leagues" class="tab-content">
                <div id="leaguesContainer"></div>
            </div>

            <div id="specialty-leagues" class="tab-content">
                <div id="specialtyLeaguesContainer"></div>
            </div>

            <div id="daily-adjustments" class="tab-content">
                <div id="daily-adjustments-content"></div>
            </div>
            
            <div id="report" class="tab-content">
                <div id="report-content"></div>
            </div>

            <div id="print" class="tab-content">
                <div id="print-content"></div>
            </div>

            <div id="updates" class="tab-content">
                <div id="updates-content"></div>
            </div>

            <div id="helper" class="tab-content">
                <div id="helper-content"></div>
            </div>
        </main>
    </div> 

    <script src="welcome.js" defer></script>
    <script src="calendar.js" defer></script>
    <script src="app1.js" defer></script>
    <script src="daily_adjustments.js" defer></script>
    <script src="fields.js" defer></script>
    <script src="special_activities.js" defer></script>
    <script src="leagues.js" defer></script>
    <script src="specialty_leagues.js" defer></script> 
    <script src="master_schedule_builder.js" defer></script>
    <script src="scheduler_logic_core.js" defer></script>
    <script src="scheduler_logic_fillers.js" defer></script>
    <script src="scheduler_ui.js" defer></script>
    <script src="analytics.js" defer></script>
    <script src="validator.js" defer></script>
    <script src="print_center.js" defer></script>
    <script src="helper.js" defer></script>
    <script src="updates.js" defer></script>

    <script>
        // Sidebar Toggle Logic
        const menuToggle = document.getElementById('menu-toggle');
        const appContainer = document.getElementById('main-app-container');
        
        if(menuToggle && appContainer) {
            menuToggle.addEventListener('click', () => {
                appContainer.classList.toggle('sidebar-closed');
            });
        }

        function showTab(id) {
            document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            
            const btn = document.querySelector(`.tab-button[onclick^="showTab('${id}')"]`);
            if(btn) btn.classList.add('active');
            
            const titleMap = {
                'setup': 'Camp Setup', 'fields': 'Fields & Locations', 'master-scheduler': 'Master Templates',
                'daily-adjustments': 'Daily Schedule Builder', 'schedule': 'Schedule View', 'leagues': 'Leagues',
                'specialty-leagues': 'Specialty Leagues', 'report': 'Analytics', 'print': 'Print Center'
            };
            document.getElementById('page-title').textContent = titleMap[id] || 'Dashboard';

            if (id === 'schedule') window.updateTable?.();
            else if (id === 'leagues') window.initLeagues?.();
            else if (id === 'specialty-leagues') window.initSpecialtyLeagues?.();
            else if (id === 'master-scheduler') window.initMasterScheduler?.();
            else if (id === 'fields') window.initFieldsTab?.();
            else if (id === 'special_activities') window.initSpecialActivitiesTab?.();
            else if (id === 'daily-adjustments') window.initDailyAdjustments?.();
            else if (id === 'report') window.initReportTab?.(); 
            else if (id === 'print') window.initPrintCenter?.();
            else if (id === 'helper') window.initHelperTab?.();
            else if (id === 'updates') window.initUpdatesTab?.();
        }
    </script>
</body>
</html>
