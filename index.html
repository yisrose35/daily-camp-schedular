<!DOCTYPE html>
<html>
<head>
  <title>Camp Scheduler</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    .tabs { margin-bottom: 20px; }
    .tab-button { padding: 10px 20px; cursor: pointer; border: 1px solid #ccc; background: #f0f0f0; margin-right: 5px; }
    .tab-button.active { background: #007BFF; color: white; font-weight: bold; }
    .tab-content { display: none; }
    .tab-content.active { display: block; }
    table { border-collapse: collapse; margin-top: 20px; width: 100%; }
    th, td { border: 1px solid black; padding: 8px; text-align: center; min-width: 80px; }
    .bunk-button { margin: 2px; padding: 5px 10px; cursor: pointer; border: 1px solid #333; border-radius: 4px; display: inline-block; }
    .selected { outline: 3px solid #90CAF9; }
    .divisionWrapper { display: inline-block; margin-right: 10px; }
    .colorPicker { width: 30px; height: 30px; border: none; cursor: pointer; vertical-align: middle; }
    .fieldWrapper { border: 1px solid #ccc; padding: 10px; margin: 10px 0; border-radius: 6px; }
    .fieldWrapper.unavailable { opacity: 0.5; }
    .activity-button { margin: 2px; padding: 4px 8px; border: 1px solid #333; border-radius: 3px; cursor: pointer; }
    .activity-button.active { background: #007BFF; color: white; }
    .switch { position: relative; display: inline-block; width: 40px; height: 20px; }
    .switch input { opacity: 0; width: 0; height: 0; }
    .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0;
      background-color: #ccc; transition: .4s; border-radius: 20px; }
    .slider:before { position: absolute; content: ""; height: 14px; width: 14px; left: 3px; bottom: 3px;
      background-color: white; transition: .4s; border-radius: 50%; }
    input:checked + .slider { background-color: #4CAF50; }
    input:checked + .slider:before { transform: translateX(20px); }
    input.time-input { width: 90px; text-align: center; font-family: monospace; }
  </style>
</head>
<body>
  <h1>Camp Scheduler</h1>

  <div class="tabs">
    <button class="tab-button active" onclick="showTab('setup')">Setup & Configuration</button>
    <button class="tab-button" onclick="showTab('schedule')">Daily Schedule</button>
  </div>

  <!-- Setup Tab -->
  <div id="setup" class="tab-content active">
    <h3>Add Bunks</h3>
    <input id="bunkInput" placeholder="Enter bunk">
    <button onclick="addBunk()">Add Bunk</button>

    <h3>Add Divisions</h3>
    <input id="divisionInput" placeholder="Enter division name">
    <button onclick="addDivision()">Add Division</button>
    <label><input type="checkbox" id="enableColor" checked> Enable colors</label>
    <div id="divisionButtons"></div>

    <h3>Generate Times</h3>
    Start: <input type="text" id="startTime" class="time-input" value="__:__">
    End: <input type="text" id="endTime" class="time-input" value="__:__">
    Increment:
    <select id="increment">
      <option value="15">15 min</option>
      <option value="30">30 min</option>
      <option value="45">45 min</option>
      <option value="60">60 min</option>
    </select>
    <button onclick="generateTimes()">Generate</button>

    <h4>Unassigned Bunks</h4>
    <div id="unassignedBunks"></div>

    <h3>Add Fields/Courts</h3>
    <input id="fieldInput" placeholder="Enter field/court name (e.g., Court #1)">
    <button onclick="addField()">Add Field/Court</button>
    <div id="fieldList"></div>
  </div>

  <!-- Schedule Tab -->
  <div id="schedule" class="tab-content">
    <table id="scheduleTable" style="display:none;">
      <thead>
        <tr id="divisionRow"></tr>
        <tr id="bunkRow"></tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <script>
    // ================== TAB SWITCHING ==================
    function showTab(id){
      document.querySelectorAll('.tab-button').forEach(b=>b.classList.remove('active'));
      document.querySelectorAll('.tab-content').forEach(c=>c.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      document.querySelector(`.tab-button[onclick="showTab('${id}')"]`).classList.add('active');
      if(id==='schedule') updateTable();
    }

    // ================== DATA ==================
    let bunks = [];
    let divisions = {};
    let availableDivisions = [];
    let selectedDivision = null;
    let times = [];
    let fields = [];
    const commonActivities = ["Basketball","Football","Baseball","Hockey","Volleyball","Soccer","Lacrosse"];
    const defaultColors = ['#4CAF50','#2196F3','#E91E63','#FF9800','#9C27B0','#00BCD4','#FFC107','#F44336'];
    let colorIndex = 0;

    // ================== TIME INPUT MASK ==================
    function setupTimeInput(input){
      input.addEventListener("input", function(){
        let val=this.value.replace(/[^0-9APMapm:]/g,"");
        // Ensure colon stays at position 2
        if(val.length<=2){
          val=val.replace(":",""); // remove stray colon
          if(val.length===2) val=val+":";
        } else {
          if(val[2]!==":") val=val.slice(0,2)+":"+val.slice(2);
        }
        this.value=val.toUpperCase();
      });
    }
    setupTimeInput(document.getElementById("startTime"));
    setupTimeInput(document.getElementById("endTime"));

    document.getElementById("startTime").addEventListener("keyup", function(){
      if(this.value.match(/(AM|PM)$/i)){ document.getElementById("endTime").focus(); }
    });
    document.getElementById("endTime").addEventListener("keyup", function(e){
      if(e.key==="Enter" && this.value.match(/(AM|PM)$/i)){ generateTimes(); }
    });

    // ================== BUNKS ==================
    function addBunk(){
      const input=document.getElementById("bunkInput");
      if(input.value.trim()!==""){
        bunks.push(input.value.trim());
        input.value="";
        updateUnassigned();
        updateTable();
      }
    }
    function updateUnassigned(){
      const container=document.getElementById("unassignedBunks");
      container.innerHTML="";
      const assignedBunks=Object.values(divisions).flatMap(d=>d.bunks);
      const unassigned=bunks.filter(b=>!assignedBunks.includes(b));
      unassigned.forEach(bunk=>{
        const span=document.createElement("span");
        span.textContent=bunk;
        span.className="bunk-button";
        span.onclick=()=>{
          if(selectedDivision){
            divisions[selectedDivision].bunks.push(bunk);
            updateUnassigned(); updateTable();
          } else alert("Select a division first!");
        };
        container.appendChild(span);
      });
    }

    // ================== DIVISIONS ==================
    function addDivision(){
      const input=document.getElementById("divisionInput");
      if(input.value.trim()==="") return;
      const divName=input.value.trim();
      if(!availableDivisions.includes(divName)){
        const color=defaultColors[colorIndex % defaultColors.length]; colorIndex++;
        availableDivisions.push(divName);
        divisions[divName]={ bunks: [], color: color };
        input.value="";
        setupDivisionButtons(); updateTable();
      }
    }
    function setupDivisionButtons(){
      const container=document.getElementById("divisionButtons");
      container.innerHTML="";
      const colorEnabled=document.getElementById("enableColor").checked;
      availableDivisions.forEach(divName=>{
        const divObj=divisions[divName];
        const wrapper=document.createElement("div");
        wrapper.className="divisionWrapper";
        const span=document.createElement("span");
        span.textContent=divName;
        span.className="bunk-button";
        span.style.backgroundColor=colorEnabled?divObj.color:"transparent";
        span.onclick=()=>{
          selectedDivision=divName;
          Array.from(container.getElementsByTagName('span')).forEach(c=>c.classList.remove("selected"));
          span.classList.add("selected");
        };
        wrapper.appendChild(span);
        const colorInput=document.createElement("input");
        colorInput.type="color"; colorInput.value=divObj.color; colorInput.className="colorPicker";
        colorInput.addEventListener("input", e=>{ divObj.color=e.target.value; updateTable(); });
        wrapper.appendChild(colorInput);
        container.appendChild(wrapper);
      });
    }

    // ================== TIMES ==================
    function generateTimes(){
      const startInput=document.getElementById("startTime").value.trim();
      const endInput=document.getElementById("endTime").value.trim();
      const increment=parseInt(document.getElementById("increment").value);

      function parseTime(str){
        const match=str.match(/^(\d{1,2}):(\d{2})\s*(AM|PM)$/i);
        if(!match) return null;
        let h=parseInt(match[1],10);
        const m=parseInt(match[2],10);
        const ampm=match[3].toUpperCase();
        if(ampm==="PM" && h!==12) h+=12;
        if(ampm==="AM" && h===12) h=0;
        return new Date(0,0,0,h,m);
      }

      const start=parseTime(startInput);
      const end=parseTime(endInput);
      if(!start || !end || start>=end){ alert("Invalid times"); return; }

      times=[];
      let current=new Date(start);
      function format(d){
        let h=d.getHours();
        let m=d.getMinutes().toString().padStart(2,"0");
        let ampm=h>=12?"PM":"AM";
        h=h%12||12;
        return `${h}:${m} ${ampm}`;
      }
      while(current<end){
        let next=new Date(current.getTime()+increment*60000);
        if(next>end) next=end;
        times.push(`${format(current)} - ${format(next)}`);
        current=next;
      }
      updateTable();
    }

    // ================== FIELDS ==================
    function addField(){
      const input=document.getElementById("fieldInput");
      const fieldName=input.value.trim();
      if(fieldName){
        fields.push({name: fieldName, activities: [], available:true});
        input.value=""; renderFields();
      }
    }
    function renderFields(){
      const container=document.getElementById("fieldList");
      container.innerHTML="";
      fields.forEach(field=>{
        const wrapper=document.createElement("div");
        wrapper.className="fieldWrapper"; if(!field.available) wrapper.classList.add("unavailable");
        const title=document.createElement("h4"); title.textContent=field.name; wrapper.appendChild(title);
        const toggle=document.createElement("label"); toggle.className="switch";
        const cb=document.createElement("input"); cb.type="checkbox"; cb.checked=field.available;
        cb.onchange=()=>{field.available=cb.checked; renderFields();};
        const slider=document.createElement("span"); slider.className="slider";
        toggle.appendChild(cb); toggle.appendChild(slider); wrapper.appendChild(toggle);
        commonActivities.forEach(act=>{
          const btn=document.createElement("button");
          btn.textContent=act; btn.className="activity-button";
          if(field.activities.includes(act)) btn.classList.add("active");
          btn.onclick=()=>{
            if(field.activities.includes(act)) field.activities=field.activities.filter(a=>a!==act);
            else field.activities.push(act); renderFields();
          };
          wrapper.appendChild(btn);
        });
        const other=document.createElement("input"); other.placeholder="Other activity";
        other.onkeyup=(e)=>{ if(e.key==="Enter" && other.value.trim()){ field.activities.push(other.value.trim()); other.value=""; renderFields(); }};
        wrapper.appendChild(other);
        if(field.activities.length>0){ const chosen=document.createElement("p"); chosen.textContent="Activities: "+field.activities.join(", "); wrapper.appendChild(chosen); }
        container.appendChild(wrapper);
      });
    }

    // ================== SCHEDULE ==================
    function updateTable(){
      const table=document.getElementById("scheduleTable");
      if(times.length===0) return; table.style.display="table";
      const divRow=document.getElementById("divisionRow"); const bunkRow=document.getElementById("bunkRow");
      divRow.innerHTML="<th>Division</th>"; bunkRow.innerHTML="<th>Bunk</th>";
      availableDivisions.forEach(divName=>{
        const divObj=divisions[divName]; const bunksInDiv=divObj.bunks;
        const thDiv=document.createElement("th"); thDiv.colSpan=Math.max(bunksInDiv.length,1);
        thDiv.style.backgroundColor=divObj.color; thDiv.style.color="white"; thDiv.textContent=divName;
        divRow.appendChild(thDiv);
        bunksInDiv.forEach(bunk=>{ const thBunk=document.createElement("th"); thBunk.textContent=bunk; bunkRow.appendChild(thBunk); });
      });
      const tbody=document.querySelector("#scheduleTable tbody"); tbody.innerHTML="";
      times.forEach(time=>{
        const row=document.createElement("tr"); const tdTime=document.createElement("td"); tdTime.textContent=time; row.appendChild(tdTime);
        availableDivisions.forEach(divName=>{ divisions[divName].bunks.forEach(()=>{ row.appendChild(document.createElement("td")); }); });
        tbody.appendChild(row);
      });
    }
  </script>
</body>
</html>    <div id="fieldList"></div>
  </div>

  <!-- Schedule Tab -->
  <div id="schedule" class="tab-content">
    <table id="scheduleTable" style="display:none;">
      <thead>
        <tr id="divisionRow"></tr>
        <tr id="bunkRow"></tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <script>
    // ================== TAB SWITCHING ==================
    function showTab(id){
      document.querySelectorAll('.tab-button').forEach(b=>b.classList.remove('active'));
      document.querySelectorAll('.tab-content').forEach(c=>c.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      document.querySelector(`.tab-button[onclick="showTab('${id}')"]`).classList.add('active');
      if(id==='schedule') updateTable();
    }

    // ================== DATA ==================
    let bunks = [];
    let divisions = {};
    let availableDivisions = [];
    let selectedDivision = null;
    let times = [];
    let fields = [];
    const commonActivities = ["Basketball","Football","Baseball","Hockey","Volleyball","Soccer","Lacrosse"];
    const defaultColors = ['#4CAF50','#2196F3','#E91E63','#FF9800','#9C27B0','#00BCD4','#FFC107','#F44336'];
    let colorIndex = 0;

    // ================== BUNKS ==================
    function addBunk(){
      const input = document.getElementById("bunkInput");
      if(input.value.trim()!==""){
        bunks.push(input.value.trim());
        input.value="";
        updateUnassigned();
        updateTable();
      }
    }

    function updateUnassigned(){
      const container = document.getElementById("unassignedBunks");
      container.innerHTML="";
      const assignedBunks = Object.values(divisions).flatMap(d=>d.bunks);
      const unassigned = bunks.filter(b=>!assignedBunks.includes(b));
      unassigned.forEach(bunk=>{
        const span=document.createElement("span");
        span.textContent=bunk;
        span.className="bunk-button";
        span.onclick=()=>{
          if(selectedDivision){
            divisions[selectedDivision].bunks.push(bunk);
            updateUnassigned();
            updateTable();
          } else { alert("Select a division first!"); }
        };
        container.appendChild(span);
      });
    }

    // ================== DIVISIONS ==================
    function addDivision(){
      const input = document.getElementById("divisionInput");
      if(input.value.trim()==="") return;
      const divName=input.value.trim();
      if(!availableDivisions.includes(divName)){
        const color=defaultColors[colorIndex % defaultColors.length]; colorIndex++;
        availableDivisions.push(divName);
        divisions[divName]={ bunks: [], color: color };
        input.value="";
        setupDivisionButtons();
        updateTable();
      }
    }

    function setupDivisionButtons(){
      const container=document.getElementById("divisionButtons");
      container.innerHTML="";
      const colorEnabled=document.getElementById("enableColor").checked;
      availableDivisions.forEach(divName=>{
        const divObj=divisions[divName];
        const wrapper=document.createElement("div");
        wrapper.className="divisionWrapper";
        const span=document.createElement("span");
        span.textContent=divName;
        span.className="bunk-button";
        span.style.backgroundColor=colorEnabled?divObj.color:"transparent";
        span.onclick=()=>{
          selectedDivision=divName;
          Array.from(container.getElementsByTagName('span')).forEach(c=>c.classList.remove("selected"));
          span.classList.add("selected");
        };
        wrapper.appendChild(span);
        const colorInput=document.createElement("input");
        colorInput.type="color";
        colorInput.value=divObj.color;
        colorInput.className="colorPicker";
        colorInput.addEventListener("input", e=>{
          divObj.color=e.target.value;
          updateTable();
        });
        wrapper.appendChild(colorInput);
        container.appendChild(wrapper);
      });
    }

    // ================== TIMES ==================
    function generateTimes(){
      const startInput=document.getElementById("startTime").value.trim();
      const endInput=document.getElementById("endTime").value.trim();
      const increment=parseInt(document.getElementById("increment").value);

      function parseTime(str){
        const match=str.match(/^(\d{1,2}):(\d{2})\s*(AM|PM)$/i);
        if(!match) return null;
        let h=parseInt(match[1],10);
        const m=parseInt(match[2],10);
        const ampm=match[3].toUpperCase();
        if(ampm==="PM" && h!==12) h+=12;
        if(ampm==="AM" && h===12) h=0;
        return new Date(0,0,0,h,m);
      }

      const start=parseTime(startInput);
      const end=parseTime(endInput);
      if(!start || !end || start>=end){ alert("Invalid times"); return; }

      times=[];
      let current=new Date(start);

      function format(d){
        let h=d.getHours();
        let m=d.getMinutes().toString().padStart(2,"0");
        let ampm=h>=12?"PM":"AM";
        h=h%12||12;
        return `${h}:${m} ${ampm}`;
      }

      while(current<end){
        let next=new Date(current.getTime()+increment*60000);
        if(next>end) next=end;
        times.push(`${format(current)} - ${format(next)}`);
        current=next;
      }
      updateTable();
    }

    // Auto colon + AM/PM flow
    function autoFormatTime(input){
      input.addEventListener("input", function(){
        let v=this.value.replace(/[^0-9APMapm]/g,"");
        if(v.length===1 && v[0]!=="1") this.value=v+":";
        else if(v.length===2 && v.startsWith("1") && !v.includes(":")) this.value=v+":";
        else this.value=v;
      });
    }
    autoFormatTime(document.getElementById("startTime"));
    autoFormatTime(document.getElementById("endTime"));

    document.getElementById("startTime").addEventListener("keyup", function(){
      if(this.value.match(/(AM|PM)$/i)){ document.getElementById("endTime").focus(); }
    });
    document.getElementById("endTime").addEventListener("keyup", function(e){
      if(e.key==="Enter" && this.value.match(/(AM|PM)$/i)){ generateTimes(); }
    });

    // ================== FIELDS ==================
    function addField(){
      const input=document.getElementById("fieldInput");
      const fieldName=input.value.trim();
      if(fieldName){
        fields.push({name: fieldName, activities: [], available:true});
        input.value=""; renderFields();
      }
    }

    function renderFields(){
      const container=document.getElementById("fieldList");
      container.innerHTML="";
      fields.forEach((field)=>{
        const wrapper=document.createElement("div");
        wrapper.className="fieldWrapper";
        if(!field.available) wrapper.classList.add("unavailable");
        const title=document.createElement("h4");
        title.textContent=field.name;
        wrapper.appendChild(title);
        const toggle=document.createElement("label");
        toggle.className="switch";
        const cb=document.createElement("input");
        cb.type="checkbox"; cb.checked=field.available;
        cb.onchange=()=>{field.available=cb.checked; renderFields();};
        const slider=document.createElement("span"); slider.className="slider";
        toggle.appendChild(cb); toggle.appendChild(slider);
        wrapper.appendChild(toggle);
        commonActivities.forEach(act=>{
          const btn=document.createElement("button");
          btn.textContent=act; btn.className="activity-button";
          if(field.activities.includes(act)) btn.classList.add("active");
          btn.onclick=()=>{
            if(field.activities.includes(act)) field.activities=field.activities.filter(a=>a!==act);
            else field.activities.push(act);
            renderFields();
          };
          wrapper.appendChild(btn);
        });
        const other=document.createElement("input");
        other.placeholder="Other activity";
        other.onkeyup=(e)=>{ if(e.key==="Enter" && other.value.trim()){ field.activities.push(other.value.trim()); other.value=""; renderFields(); }};
        wrapper.appendChild(other);
        if(field.activities.length>0){
          const chosen=document.createElement("p");
          chosen.textContent="Activities: "+field.activities.join(", ");
          wrapper.appendChild(chosen);
        }
        container.appendChild(wrapper);
      });
    }

    // ================== SCHEDULE ==================
    function updateTable(){
      const table=document.getElementById("scheduleTable");
      if(times.length===0) return;
      table.style.display="table";
      const divRow=document.getElementById("divisionRow");
      const bunkRow=document.getElementById("bunkRow");
      divRow.innerHTML="<th>Division</th>"; bunkRow.innerHTML="<th>Bunk</th>";
      availableDivisions.forEach(divName=>{
        const divObj=divisions[divName];
        const bunksInDiv=divObj.bunks;
        const thDiv=document.createElement("th");
        thDiv.colSpan=Math.max(bunksInDiv.length,1);
        thDiv.style.backgroundColor=divObj.color;
        thDiv.style.color="white"; thDiv.textContent=divName;
        divRow.appendChild(thDiv);
        bunksInDiv.forEach(bunk=>{
          const thBunk=document.createElement("th");
          thBunk.textContent=bunk;
          bunkRow.appendChild(thBunk);
        });
      });
      const tbody=document.querySelector("#scheduleTable tbody");
      tbody.innerHTML="";
      times.forEach(time=>{
        const row=document.createElement("tr");
        const tdTime=document.createElement("td");
        tdTime.textContent=time; row.appendChild(tdTime);
        availableDivisions.forEach(divName=>{
          divisions[divName].bunks.forEach(()=>{ row.appendChild(document.createElement("td")); });
        });
        tbody.appendChild(row);
      });
    }
  </script>
</body>
</html>   wrapper.className="fieldWrapper";
        if(!field.available) wrapper.classList.add("unavailable");
        const title=document.createElement("h4");
        title.textContent=field.name;
        wrapper.appendChild(title);
        const toggle=document.createElement("label");
        toggle.className="switch";
        const cb=document.createElement("input");
        cb.type="checkbox"; cb.checked=field.available;
        cb.onchange=()=>{field.available=cb.checked; renderFields();};
        const slider=document.createElement("span"); slider.className="slider";
        toggle.appendChild(cb); toggle.appendChild(slider);
        wrapper.appendChild(toggle);
        commonActivities.forEach(act=>{
          const btn=document.createElement("button");
          btn.textContent=act; btn.className="activity-button";
          if(field.activities.includes(act)) btn.classList.add("active");
          btn.onclick=()=>{
            if(field.activities.includes(act)) field.activities=field.activities.filter(a=>a!==act);
            else field.activities.push(act);
            renderFields();
          };
          wrapper.appendChild(btn);
        });
        const other=document.createElement("input");
        other.placeholder="Other activity";
        other.onkeyup=(e)=>{ if(e.key==="Enter" && other.value.trim()){ field.activities.push(other.value.trim()); other.value=""; renderFields(); }};
        wrapper.appendChild(other);
        if(field.activities.length>0){
          const chosen=document.createElement("p");
          chosen.textContent="Activities: "+field.activities.join(", ");
          wrapper.appendChild(chosen);
        }
        container.appendChild(wrapper);
      });
    }

    // ================== SCHEDULE ==================
    function updateTable(){
      const table=document.getElementById("scheduleTable");
      if(times.length===0) return;
      table.style.display="table";
      const divRow=document.getElementById("divisionRow");
      const bunkRow=document.getElementById("bunkRow");
      divRow.innerHTML="<th>Division</th>"; bunkRow.innerHTML="<th>Bunk</th>";
      availableDivisions.forEach(divName=>{
        const divObj=divisions[divName];
        const bunksInDiv=divObj.bunks;
        const thDiv=document.createElement("th");
        thDiv.colSpan=Math.max(bunksInDiv.length,1);
        thDiv.style.backgroundColor=divObj.color;
        thDiv.style.color="white"; thDiv.textContent=divName;
        divRow.appendChild(thDiv);
        bunksInDiv.forEach(bunk=>{
          const thBunk=document.createElement("th");
          thBunk.textContent=bunk;
          bunkRow.appendChild(thBunk);
        });
      });
      const tbody=document.querySelector("#scheduleTable tbody");
      tbody.innerHTML="";
      times.forEach(time=>{
        const row=document.createElement("tr");
        const tdTime=document.createElement("td");
        tdTime.textContent=time; row.appendChild(tdTime);
        availableDivisions.forEach(divName=>{
          divisions[divName].bunks.forEach(()=>{ row.appendChild(document.createElement("td")); });
        });
        tbody.appendChild(row);
      });
    }
  </script>
</body>
</html>
